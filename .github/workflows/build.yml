name: Build Cheat Engine
on: [push, pull_request, workflow_dispatch]

jobs:
  build:
    runs-on: windows-latest
    
    steps:
      - name: Checkout Source
        uses: actions/checkout@v4
        with:
          submodules: recursive

      - name: Install Lazarus
        uses: gcarreno/setup-lazarus@v3
        with:
          lazarus-version: 'stable'
          with-higher-fpc: true

      - name: Build Cheat Engine (64-bit)
        run: |
          cd "Cheat Engine"
          lazbuild --os=win64 --cpu=x86_64 --build-mode=Release cheatengine.lpi

      - name: Upload Build Artifacts
        uses: actions/upload-artifact@v4
        with:
          name: Cheat-Engine-Win64
          path: |
            Cheat Engine/bin/*.exe
            Cheat Engine/bin/*.dll
